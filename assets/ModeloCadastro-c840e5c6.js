import{M as C}from"./ModeloService-10ae08ab.js";import{M as x}from"./MarcaService-93547b35.js";import{_ as V,l as w,m as k,n as T,b as i,c as b,d as v,f as s,e as o,t as n,g as d,F as B,k as E,q as f}from"./index-b821698f.js";import{c as I,a as D,b as N}from"./index.esm-960d875f.js";import"./UrlService-8cfe23a9.js";const F={name:"ModeloCadastro",components:{},setup(){const r=w(),e=k(),l=new C,t=new x,{errors:a,handleSubmit:m,defineField:c}=T({validationSchema:I({nome:D().required("Campo obrigatório"),idMarca:N().required("Campo obrigatório")})}),[u]=c("nome"),[h]=c("idMarca");return{router:r,toast:e,modeloService:l,marcaService:t,nome:u,idMarca:h,handleSubmit:m,errors:a}},data(){return{breadcrumbHome:{icon:"pi pi-home",to:"/"},breadcrumbItems:[],marcas:[],titulo:"",isEdicao:!1,id:0,onSubmit:null,loading:!1}},async mounted(){if(this.isEdicao=this.router.currentRoute.value.fullPath.includes("editar"),this.titulo=this.isEdicao?"Editar modelo":"Novo modelo",this.breadcrumbItems=[{label:"Cadastros",to:"/cadastros/modelos"},{label:"Modelos",to:"/cadastros/modelos"},{label:this.titulo,to:"#"}],this.marcas=await this.marcaService.getOptions(),this.isEdicao){const r=this.router.currentRoute.value.params.id,e=await this.modeloService.get(r);this.id=e.id,this.nome=e.nome,this.idMarca=e.marca.id}this.onSubmit=this.handleSubmit(async r=>{const e={id:this.id,nome:r.nome,idMarca:r.idMarca};try{this.loading=!0,this.id?await this.modeloService.update(e):await this.modeloService.create(e),this.toast.add({severity:"success",summary:"Cadastro salvo com sucesso",detail:"",life:3e3}),setTimeout(()=>{this.router.push("/cadastros/modelos")},400)}catch(l){this.toast.add({severity:"error",summary:l.message,detail:"",life:3e3}),this.loading=!1}})},methods:{submit:async function(){this.onSubmit()}}},P={class:"font-medium text-2xl text-color"},q={class:"grid p-fluid"},R={class:"col-12 md:col-12"},H={class:"card"},O={key:0},U={class:"p-input-title"},z={class:"grid formgrid"},G={class:"col-12 mb-2 lg:col-6"},L=o("h6",{class:"p-input-title"},"Nome",-1),j={class:"p-error",id:"text-error"},A={class:"grid formgrid"},J={class:"col-12 mb-2 lg:col-6"},K=o("h6",{class:"p-input-title"},"Marca",-1),Q={class:"p-error",id:"text-error"},W={class:"my-2"};function X(r,e,l,t,a,m){const c=i("Toast"),u=i("Breadcrumb"),h=i("InputText"),g=i("Dropdown"),M=i("Panel"),p=i("Button"),S=i("router-link"),y=i("Toolbar");return b(),v(B,null,[s(c),o("div",P,n(a.titulo),1),s(u,{home:a.breadcrumbHome,model:a.breadcrumbItems},null,8,["home","model"]),o("div",q,[o("div",R,[o("div",H,[o("form",null,[s(M,{header:"Dados Principais",toggleable:"",class:"mb-4"},{default:d(()=>[a.id?(b(),v("div",O,[o("h6",U,"CÓDIGO: "+n(this.id),1)])):E("",!0),o("div",z,[o("div",G,[L,s(h,{modelValue:t.nome,"onUpdate:modelValue":e[0]||(e[0]=_=>t.nome=_),class:f({"p-invalid":t.errors.nome}),type:"text"},null,8,["modelValue","class"]),o("small",j,n(t.errors.nome||""),1)])]),o("div",A,[o("div",J,[K,s(g,{modelValue:t.idMarca,"onUpdate:modelValue":e[1]||(e[1]=_=>t.idMarca=_),editable:"",options:a.marcas,optionLabel:"opcao",optionValue:"id",placeholder:"Selecione a Marca",class:f(["w-full",{"p-invalid":t.errors.idMarca}])},null,8,["modelValue","options","class"]),o("small",Q,n(t.errors.idMarca||""),1)])])]),_:1})])]),s(y,null,{start:d(()=>[s(S,{to:"/cadastros/modelos"},{default:d(()=>[s(p,{label:"Voltar",icon:"pi pi-undo",class:"p-button-secondary mr-2",raised:""})]),_:1})]),end:d(()=>[o("div",W,[s(p,{label:"Salvar",icon:"pi pi-save",class:"p-button-sucess mr-4",loading:a.loading,raised:"",onClick:m.submit},null,8,["loading","onClick"])])]),_:1})])])],64)}const to=V(F,[["render",X]]);export{to as default};
