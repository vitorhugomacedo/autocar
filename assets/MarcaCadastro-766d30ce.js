import{M as y}from"./MarcaService-93547b35.js";import{T as C}from"./TipoVeiculoService-09e12947.js";import{_ as x,l as w,m as k,n as B,b as a,c as b,d as v,f as s,e as o,t as n,g as d,F as M,k as E,q as V}from"./index-b821698f.js";import{c as I,a as D,b as N}from"./index.esm-960d875f.js";import"./UrlService-8cfe23a9.js";const F={name:"MarcaCadastro",components:{},setup(){const r=w(),e=k(),c=new y,t=new C,{errors:i,handleSubmit:m,defineField:l}=B({validationSchema:I({nome:D().required("Campo obrigatório"),idTipoVeiculo:N().required("Campo obrigatório")})}),[u]=l("nome"),[p]=l("idTipoVeiculo");return{router:r,toast:e,marcaService:c,tipoVeiculoService:t,nome:u,idTipoVeiculo:p,handleSubmit:m,errors:i}},data(){return{breadcrumbHome:{icon:"pi pi-home",to:"/"},breadcrumbItems:[],tipoVeiculos:[],titulo:"",isEdicao:!1,id:0,onSubmit:null,loading:!1}},async mounted(){if(this.isEdicao=this.router.currentRoute.value.fullPath.includes("editar"),this.titulo=this.isEdicao?"Editar Marca":"Nova Marca",this.breadcrumbItems=[{label:"Cadastros",to:"/cadastros/marcas"},{label:"Marcas",to:"/cadastros/marcas"},{label:this.titulo,to:"#"}],this.tipoVeiculos=await this.tipoVeiculoService.getOptions(),this.isEdicao){const r=this.router.currentRoute.value.params.id,e=await this.marcaService.get(r);this.id=e.id,this.nome=e.nome,this.idTipoVeiculo=e.tipoVeiculo.id}this.onSubmit=this.handleSubmit(async r=>{const e={id:this.id,nome:r.nome,idTipoVeiculo:r.idTipoVeiculo};try{this.loading=!0,this.id?await this.marcaService.update(e):await this.marcaService.create(e),this.toast.add({severity:"success",summary:"Cadastro salvo com sucesso",detail:"",life:3e3}),setTimeout(()=>{this.router.push("/cadastros/marcas")},400)}catch(c){this.toast.add({severity:"error",summary:c.message,detail:"",life:3e3}),this.loading=!1}})},methods:{submit:async function(){this.onSubmit()}}},P={class:"font-medium text-2xl text-color"},q={class:"grid p-fluid"},R={class:"col-12 md:col-12"},H={class:"card"},O={key:0},U={class:"p-input-title"},z={class:"grid formgrid"},G={class:"col-12 mb-2 lg:col-6"},L=o("h6",{class:"p-input-title"},"Nome",-1),j={class:"p-error",id:"text-error"},A={class:"grid formgrid"},J={class:"col-12 mb-2 lg:col-6"},K=o("h6",{class:"p-input-title"},"Tipo de Veículo",-1),Q={class:"p-error",id:"text-error"},W={class:"my-2"};function X(r,e,c,t,i,m){const l=a("Toast"),u=a("Breadcrumb"),p=a("InputText"),f=a("Dropdown"),g=a("Panel"),_=a("Button"),T=a("router-link"),S=a("Toolbar");return b(),v(M,null,[s(l),o("div",P,n(i.titulo),1),s(u,{home:i.breadcrumbHome,model:i.breadcrumbItems},null,8,["home","model"]),o("div",q,[o("div",R,[o("div",H,[o("form",null,[s(g,{header:"Dados Principais",toggleable:"",class:"mb-4"},{default:d(()=>[i.id?(b(),v("div",O,[o("h6",U,"CÓDIGO: "+n(this.id),1)])):E("",!0),o("div",z,[o("div",G,[L,s(p,{modelValue:t.nome,"onUpdate:modelValue":e[0]||(e[0]=h=>t.nome=h),class:V({"p-invalid":t.errors.nome}),type:"text"},null,8,["modelValue","class"]),o("small",j,n(t.errors.nome||""),1)])]),o("div",A,[o("div",J,[K,s(f,{modelValue:t.idTipoVeiculo,"onUpdate:modelValue":e[1]||(e[1]=h=>t.idTipoVeiculo=h),editable:"",options:i.tipoVeiculos,optionLabel:"opcao",optionValue:"id",placeholder:"Selecione tipo de veículo",class:V(["w-full",{"p-invalid":t.errors.idTipoVeiculo}])},null,8,["modelValue","options","class"]),o("small",Q,n(t.errors.idTipoVeiculo||""),1)])])]),_:1})])]),s(S,null,{start:d(()=>[s(T,{to:"/cadastros/marcas"},{default:d(()=>[s(_,{label:"Voltar",icon:"pi pi-undo",class:"p-button-secondary mr-2",raised:""})]),_:1})]),end:d(()=>[o("div",W,[s(_,{label:"Salvar",icon:"pi pi-save",class:"p-button-sucess mr-4",loading:i.loading,raised:"",onClick:m.submit},null,8,["loading","onClick"])])]),_:1})])])],64)}const to=x(F,[["render",X]]);export{to as default};
