import{U as E}from"./UsuarioEmpresaService-f9569951.js";import{P as R}from"./PerfilUsuarioService-ba568dd0.js";import{U as F}from"./UrlService-8cfe23a9.js";import{_ as I,y as N,m as P,b as l,p as A,c as f,d as h,f as t,e as r,g as s,j as B,F as j,q as O,t as d,i as c,k as _,s as x,B as z}from"./index-def3a469.js";import{F as L}from"./Filtros-9c86de79.js";const M={name:"UsuarioLista",components:{Filtros:L},setup(){const o=N(),a=P(),u=new F,m=new R;return{confirm:o,toast:a,urlService:u,perfilUsuarioService:m}},data(){return{breadcrumbHome:{icon:"pi pi-home",to:"/"},breadcrumbItems:[{label:"Configurações",to:"/configuracoes/usuarios"},{label:"Usuários",to:"/configuracoes/usuarios"}],filters:[],usuarioEmpresaService:null,registros:[],visible:!1,loading:!0}},async beforeMount(){this.searchRecords(),this.buildFilters()},methods:{showTemplate:function(o,a){this.confirm.require({group:"templating",header:"Confirmação",message:a,icon:"pi pi-exclamation-circle",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",rejectClass:"p-button-outlined p-button-sm",acceptClass:"p-button-sm",rejectLabel:"Cancelar",acceptLabel:"Excluir",accept:async()=>{await this.usuarioEmpresaService.delete({id:o});const u=this.registros.data.findIndex(m=>m.id==o);u>-1&&this.registros.data.splice(u,1),this.toast.add({severity:"success",summary:"Registro excluído com sucesso",detail:"",life:3e3})}})},searchRecords:async function(){this.loading=!0,this.usuarioEmpresaService=new E,this.registros=await this.usuarioEmpresaService.getAll(this.urlService.getQueryParamsObject()),this.loading=!1},buildFilters:async function(){const o=await this.perfilUsuarioService.getOptions();this.filters=[{field:"Nome",property:"nome",type:"text"},{field:"Email",property:"email",type:"text"},{field:"Perfil",property:"idPerfilUsuario",type:"multiselect",options:o}]},updateFilter:function(o){this.urlService.clearQueryParams();for(var a in o)o.hasOwnProperty(a)&&this.urlService.setParam(a,o[a]);this.searchRecords()},changePage:async function(o){this.urlService.setParam("page",o.page+1),this.searchRecords()}}},V=r("div",{class:"font-medium text-2xl text-color"},"Usuários",-1),H={class:"grid p-fluid"},q={class:"col-12 md:col-12"},Q={class:"card"},K={class:"my-2"},G={class:"flex flex-column align-items-center w-full gap-3 surface-border"},J=r("span",{class:"p-text-secondary text-align-center block mb-2 pt-2"},[c("Não é permitido Editar ou Excluir"),r("br"),c(" o usuário ADMINISTRADOR.")],-1),W={class:"flex justify-content-end gap-2"},X=r("i",{class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}},null,-1),Y={style:{"vertical-align":"middle"},class:"image-text"},Z={key:0},$={key:1};function ee(o,a,u,m,i,g){const w=l("Breadcrumb"),p=l("Button"),b=l("router-link"),C=l("Toolbar"),S=l("ConfirmDialog"),U=l("Dialog"),k=l("Filtros"),n=l("Column"),v=l("Tag"),D=l("DataTable"),T=l("Toast"),y=A("tooltip");return f(),h(j,null,[V,t(w,{home:i.breadcrumbHome,model:i.breadcrumbItems},null,8,["home","model"]),r("div",H,[r("div",q,[r("div",Q,[t(C,{class:"mb-4"},{end:s(()=>[r("div",K,[t(b,{to:"/configuracoes/usuarios/novo"},{default:s(()=>[t(p,{label:"Novo",icon:"pi pi-plus",class:"p-button-primary mr-2"})]),_:1})])]),_:1}),t(S,{group:"templating"},{message:s(e=>[r("div",G,[r("i",{class:O([e.message.icon,"text-6xl text-primary-500"])},null,2),r("p",null,d(e.message.message),1)])]),_:1}),t(U,{visible:i.visible,"onUpdate:visible":a[1]||(a[1]=e=>i.visible=e),header:"Confirmação",style:{width:"25rem"}},{default:s(()=>[J,r("div",W,[t(p,{type:"button",label:"Ok",onClick:a[0]||(a[0]=e=>i.visible=!1)})])]),_:1},8,["visible"]),t(D,{value:i.registros.data,paginator:"",lazy:"",first:(i.registros.currentPage-1)*i.registros.pageSize,rows:i.registros.pageSize,totalRecords:i.registros.count,class:"p-datatable backgroud-color-white",dataKey:"id",rowHover:!0,filterDisplay:"menu",loading:i.loading,responsiveLayout:"scroll"},B({header:s(()=>[t(k,{filters:i.filters,updateFilter:g.updateFilter},null,8,["filters","updateFilter"])]),loading:s(()=>[X]),footer:s(()=>[]),default:s(()=>[t(n,{field:"id",header:"Cód.",bodyClass:"text-left",style:{"min-width":"3rem"}},{body:s(({data:e})=>[r("span",Y,d(e.id),1)]),_:1}),t(n,{field:"nome",header:"Nome",style:{"min-width":"12rem"}},{body:s(({data:e})=>[c(d(e.nome),1)]),_:1}),t(n,{field:"email",header:"E-mail",style:{"min-width":"12rem"}},{body:s(({data:e})=>[c(d(e.email),1)]),_:1}),t(n,{field:"perfil",header:"Perfil",style:{"min-width":"8rem"}},{body:s(({data:e})=>[c(d(e.perfilUsuario.descricao),1)]),_:1}),t(n,{field:"Ativo",header:"Status",dataType:"boolean",bodyClass:"text-left",style:{"min-width":"1rem",width:"1rem"}},{body:s(({data:e})=>[e.ativo?(f(),h("div",Z,[t(v,{class:"mr-2 ml-2",style:{width:"3rem"},severity:"success",value:"Ativo"})])):_("",!0),e.ativo?_("",!0):(f(),h("div",$,[t(v,{class:"mr-2 ml-2",style:{width:"3rem"},severity:"danger",value:"Inativo"})]))]),_:1}),t(n,{field:"Edit",header:"",dataType:"boolean",bodyClass:"text-right",style:{"min-width":"10rem"}},{body:s(({data:e})=>[t(b,{to:`/configuracoes/usuarios/editar/${e.id}`},{default:s(()=>[e.perfilUsuario.descricao!=="ADMINISTRADOR"?x((f(),z(p,{key:0,icon:"pi pi-user-edit",class:"p-button-rounded p-button-text mr-4",text:"",rounded:""},null,512)),[[y,"Editar",void 0,{top:!0}]]):_("",!0)]),_:2},1032,["to"]),x(t(p,{icon:"pi pi-trash",class:"p-button-rounded p-button-text",text:"",rounded:"",onClick:te=>e.perfilUsuario.descricao==="ADMINISTRADOR"?i.visible=!0:g.showTemplate(e.id,`Deseja realmente excluir o usuário ${e.perfilUsuario.descricao}?`)},null,8,["onClick"]),[[y,"Excluir",void 0,{top:!0}]])]),_:1})]),_:2},[i.loading?void 0:{name:"empty",fn:s(()=>[c("Nenhum usuário encontrado. ")]),key:"0"}]),1032,["value","first","rows","totalRecords","loading"])])]),t(T)])],64)}const le=I(M,[["render",ee]]);export{le as default};
