var R=Object.defineProperty;var O=(t,e,c)=>e in t?R(t,e,{enumerable:!0,configurable:!0,writable:!0,value:c}):t[e]=c;var A=(t,e,c)=>(O(t,typeof e!="symbol"?e+"":e,c),c);import{V as P}from"./VeiculoService-b8e53282.js";import{T as z}from"./TipoVeiculoService-4381615b.js";import{M as H}from"./MarcaService-874d42df.js";import{M as K}from"./ModeloService-d171b76f.js";import{V as G}from"./VeiculoCombustivelService-e44b9f55.js";import{T as J}from"./TabControl-34c61792.js";import{A as E,_ as N,m as q,b as n,c as p,d as _,f as l,g as u,e as o,F as M,z as U,t as m,l as Q,n as W,p as X,q as f,k as x,B,K as Y,j as Z,i as V,s as L,v as $,x as oo}from"./index-777c8e91.js";import{c as eo,a as C}from"./index.esm-960d875f.js";import"./UrlService-8cfe23a9.js";class io{constructor(){A(this,"get",async e=>await E.$axios.get(`VeiculoItemAdicional/${e}`).then(c=>c.data.data));A(this,"save",async e=>await E.$axios.post("VeiculoItemAdicional",e).then(c=>c.data.data))}}const so={name:"VeiculoItemAdicionalCadastro",components:{},props:{idVeiculo:{type:Number,default:0}},setup(){const t=q(),e=new io;return{toast:t,veiculoItemAdicionalService:e}},data(){return{itensAdicionais:[],loading:!1,selecionados:[]}},async mounted(){this.itensAdicionais=await this.veiculoItemAdicionalService.get(this.idVeiculo),this.selecionados=this.itensAdicionais.filter(t=>t.selecionado).map(t=>t.id),console.log(this.selecionados)},methods:{submit:async function(){const t={idVeiculo:this.idVeiculo,idItensAdicionais:this.selecionados};try{this.loading=!0,await this.veiculoItemAdicionalService.save(t),this.toast.add({severity:"success",summary:"Cadastro salvo com sucesso",detail:"",life:3e3})}catch(e){this.toast.add({severity:"error",summary:e.message,detail:"",life:3e3})}this.loading=!1}}},lo={class:"flex flex-column justify-content-between"},to={class:"grid formgrid"},ao={class:"col-12 mb-2 lg:col-2 lg:mb-2 md:col-5"},co=["for"],no={class:"col-12 lg:col-12"},ro={class:"grid formgrid p-fluid"},uo={class:""},mo=["for"],po={class:"col-12 lg:col-12"},vo={class:"grid formgrid p-fluid"},_o={class:"col-12 flex justify-content-end md:col-12 sm:justify-content-center"};function ho(t,e,c,i,a,T){const w=n("Toast"),S=n("Checkbox"),I=n("ToggleButton"),h=n("ScrollTop"),b=n("ScrollPanel"),g=n("Button");return p(),_(M,null,[l(b,null,{default:u(()=>[l(w),o("div",lo,[o("div",to,[o("div",ao,[(p(!0),_(M,null,U(a.itensAdicionais,d=>(p(),_("div",{key:d.id,class:"flex align-items-center"},[l(S,{class:"mr-2",modelValue:a.selecionados,"onUpdate:modelValue":e[0]||(e[0]=v=>a.selecionados=v),inputId:d.nome,name:"itemAdicional",value:d.id},null,8,["modelValue","inputId","value"]),o("label",{for:d.nome},m(d.nome),9,co)]))),128))])]),o("div",no,[o("div",ro,[(p(!0),_(M,null,U(a.itensAdicionais,d=>(p(),_("div",{class:"flex field p-1 col-12 md:col-3",key:d.id},[l(I,{value:d.id,modelValue:a.selecionados,"onUpdate:modelValue":e[1]||(e[1]=v=>a.selecionados=v),inputId:d.nome,name:"itemAdicional",onLabel:"Locked",offLabel:"",onIcon:"pi pi-check",offIcon:"fa-regular fa-ban",class:"w-2rem h-2rem mr-2","aria-label":"Do you confirm"},null,8,["value","modelValue","inputId"]),o("div",uo,[o("h6",{class:"",for:d.nome},m(d.nome),9,mo)])]))),128))])])]),l(h,{target:"parent",threshold:100,icon:"pi pi-arrow-up",pt:{root:"w-2rem h-2rem border-round-sm bg-primary",icon:{class:"text-base"}}})]),_:1}),o("div",po,[o("div",vo,[o("div",_o,[l(g,{label:"Salvar Itens Adicionais",icon:"pi pi-save",class:"p-button-sucess w-15rem",loading:a.loading,raised:"",onClick:T.submit},null,8,["loading","onClick"])])])])],64)}const bo=N(so,[["render",ho]]);const fo={name:"VeiculoCadastro",components:{TabControl:J,VeiculoItemAdicionalCadastro:bo},data(){return{breadcrumbHome:{icon:"pi pi-home",to:"/"},breadcrumbItems:[],tabAtiva:0,tabItens:[],titulo:"",isEdicao:!1,id:0,onSubmit:null,tipoVeiculos:[],marcas:[],modelos:[],combustiveis:[],loading:!1}},setup(){const t=Q(),e=q(),c=new P,i=new z,a=new H,T=new K,w=new G,{errors:S,handleSubmit:I,defineField:h}=W({validationSchema:eo({placa:C().required("Campo obrigatório"),renavam:C().required("Campo obrigatório"),idTipoVeiculo:C().required("Campo obrigatório"),idMarca:C().required("Campo obrigatório"),idModelo:C().required("Campo obrigatório"),idVeiculoCombustivel:C().required("Campo obrigatório")})}),[b]=h("placa"),[g]=h("renavam"),[d]=h("idTipoVeiculo"),[v]=h("idMarca"),[y]=h("idModelo"),[k]=h("idVeiculoCombustivel");return{router:t,toast:e,veiculoService:c,tipoVeiculoService:i,marcaService:a,modeloService:T,combustvelService:w,placa:b,renavam:g,idTipoVeiculo:d,idMarca:v,idModelo:y,idVeiculoCombustivel:k,handleSubmit:I,errors:S}},async mounted(){if(this.isEdicao=this.router.currentRoute.value.fullPath.includes("editar"),this.titulo=this.isEdicao?"Editar Veículo":"Novo Veículo",this.breadcrumbItems=[{label:"Cadastros",to:"/cadastros/veiculos"},{label:"Veículos",to:"/cadastros/veiculos"},{label:this.titulo,to:"#"}],this.tipoVeiculos=await this.tipoVeiculoService.getOptions(),this.isEdicao){const t=this.router.currentRoute.value.params.id,e=await this.veiculoService.get(t);this.id=e.id,this.placa=e.placa,this.renavam=e.renavam}this.mountTabs(),this.onSubmit=this.handleSubmit(async t=>{const e={id:this.id,placa:t.placa,renavam:t.renavam,idTipoVeiculo:t.idTipoVeiculo,idMarca:t.idMarca,idModelo:t.idModelo,idVeiculoCombustivel:t.idVeiculoCombustivel};try{this.loading=!0;let c=null;this.id?await this.veiculoService.update(e):c=await this.veiculoService.create(e),this.toast.add({severity:"success",summary:"Veículo salvo com sucesso",detail:"",life:3e3}),setTimeout(()=>{this.isEdicao?this.router.push("/cadastros/veiculos"):(this.id=c.id,this.isEdicao=!0,this.router.push(`/cadastros/veiculos/editar/${c.id}`),this.mountTabs())},400),this.loading=!1}catch(c){this.toast.add({severity:"error",summary:c.message,detail:"",life:3e3}),this.loading=!1}})},computed:{},methods:{submit:async function(){this.onSubmit()},mountTabs:function(){this.tabItens=[{label:"Dados Iniciais",icon:"pi pi-car",blocked:!1},{label:"Consignação",icon:"pi pi-sync",blocked:!this.isEdicao},{label:"Itens Adicionais",icon:"pi pi-list",blocked:!this.isEdicao},{label:"Despesas / Débitos",icon:"pi pi-dollar",blocked:!this.isEdicao},{label:"Anexos",icon:"pi pi-file",blocked:!this.isEdicao},{label:"Checklist",icon:"pi pi-check-circle",blocked:!this.isEdicao}]},onAdvancedUpload(){this.$toast.add({severity:"info",summary:"Success",detail:"File Uploaded",life:3e3})}},watch:{idTipoVeiculo:async function(){this.marcas=await this.marcaService.getOptions({idTipoVeiculo:this.idTipoVeiculo}),this.combustiveis=await this.combustvelService.getOptions({idTipoVeiculo:this.idTipoVeiculo})},idMarca:async function(){this.modelos=await this.modeloService.getOptions({idMarca:this.idMarca})}}},r=t=>($("data-v-c6af43b5"),t=t(),oo(),t),Vo=r(()=>o("div",{class:"font-medium text-2xl text-color"},"Novo Veículo",-1)),go={class:"grid p-fluid"},yo={class:"col-12 md:col-12"},xo={class:"flex flex-column md:flex-row gap-5 mb-5"},Co={class:"card flex-1"},To={key:0},wo={class:"grid formgrid"},So={class:"col-12 mb-2 lg:col-3 lg:mb-2 md:col-6"},Io=r(()=>o("h6",{class:"p-input-title"},[V("Placa "),o("small",{style:{color:"#ff7200"}},"*")],-1)),ko={class:"p-error",id:"text-error"},Mo={class:"col-12 mb-2 lg:col-3 lg:mb-2 md:col-6"},Ao=r(()=>o("h6",{class:"p-input-title"},[V("Renavan "),o("small",{style:{color:"#ff7200"}},"*")],-1)),Do={class:"p-error",id:"text-error"},Eo={class:"grid formgrid"},Uo={class:"col-12 mb-2 lg:col-8 lg:mb-2 md:col-6"},Bo=r(()=>o("h6",{class:"p-input-title"},[V("Descrição "),o("small",{style:{color:"#ff7200"}},"*")],-1)),Lo={class:"p-error",id:"text-error"},No={class:"col-12 mb-2 lg:col-4"},qo=r(()=>o("h6",{class:"p-input-title"},[V("Tipo de Veículo "),o("small",{style:{color:"#ff7200"}},"*")],-1)),jo={class:"p-error",id:"text-error"},Fo={class:"col-12 mb-2 lg:col-4"},Ro=r(()=>o("h6",{class:"p-input-title"},[V("Marca "),o("small",{style:{color:"#ff7200"}},"*")],-1)),Oo={class:"p-error",id:"text-error"},Po={class:"col-12 mb-2 lg:col-4"},zo=r(()=>o("h6",{class:"p-input-title"},[V("Modelo "),o("small",{style:{color:"#ff7200"}},"*")],-1)),Ho={class:"p-error",id:"text-error"},Ko={class:"col-12 mb-2 lg:col-4"},Go=r(()=>o("h6",{class:"p-input-title"},[V("Combustível "),o("small",{style:{color:"#ff7200"}},"*")],-1)),Jo={class:"p-error",id:"text-error"},Qo=r(()=>o("div",{class:"grid formgrid"},null,-1)),Wo={key:1},Xo=r(()=>o("p",null,"1",-1)),Yo=[Xo],Zo={key:2},$o={class:"grid formgrid"},oe={class:"col-12 mb-2 xl:col-3 lg:col-6 lg:mb-2 md:col-12 sm:col-12"},ee=r(()=>o("h6",{class:"p-input-title"},"Código",-1)),ie={class:"p-inputgroup"},se={class:"col-12 mb-2 xl:col-5 lg:col-12 lg:mb-2 md:col-12"},le=r(()=>o("h6",{class:"p-input-title"},"Descrição",-1)),te={class:"p-error",id:"text-error"},ae={class:"col-12 mb-2 xl:col-4 lg:col-12 lg:mb-2 md:col-12"},ce=r(()=>o("h6",{class:"p-input-title"},"Valor Despesa R$",-1)),ne={class:"p-inputgroup"},de={class:"col-12"},re=r(()=>o("i",{class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}},null,-1)),ue={style:{"vertical-align":"middle"},class:"image-text"},me={key:0},pe={key:3},ve={class:"my-2"};function _e(t,e,c,i,a,T){const w=n("Toast"),S=n("Breadcrumb"),I=n("TabControl"),h=n("TabMenu"),b=n("InputText"),g=n("Dropdown"),d=n("VeiculoItemAdicionalCadastro"),v=n("Button"),y=n("Column"),k=n("router-link"),j=n("DataTable"),F=n("Toolbar"),D=X("tooltip");return p(),_(M,null,[l(w),Vo,l(S,{home:a.breadcrumbHome,model:a.breadcrumbItems},null,8,["home","model"]),o("div",go,[o("div",yo,[o("div",xo,[l(I,{tabs:a.tabItens,onTab:e[0]||(e[0]=s=>a.tabAtiva=s)},null,8,["tabs"]),o("div",Co,[l(h,{activeIndex:a.tabAtiva,"onUpdate:activeIndex":e[1]||(e[1]=s=>a.tabAtiva=s),model:a.tabItens,visible:!1,style:{display:"none"}},null,8,["activeIndex","model"]),a.tabAtiva==0?(p(),_("div",To,[o("div",wo,[o("div",So,[Io,l(b,{type:"text",modelValue:i.placa,"onUpdate:modelValue":e[2]||(e[2]=s=>i.placa=s),placeholder:"",class:f({"p-invalid":i.errors.placa})},null,8,["modelValue","class"]),o("small",ko,m(i.errors.placa||""),1)]),o("div",Mo,[Ao,l(b,{type:"text",modelValue:i.renavam,"onUpdate:modelValue":e[3]||(e[3]=s=>i.renavam=s),placeholder:"",class:f({"p-invalid":i.errors.renavam}),inputId:"withoutgrouping",useGrouping:!1},null,8,["modelValue","class"]),o("small",Do,m(i.errors.renavam||""),1)])]),o("div",Eo,[o("div",Uo,[Bo,l(b,{type:"text",modelValue:i.placa,"onUpdate:modelValue":e[4]||(e[4]=s=>i.placa=s),placeholder:"",class:f({"p-invalid":i.errors.placa})},null,8,["modelValue","class"]),o("small",Lo,m(i.errors.placa||""),1)]),o("div",No,[qo,l(g,{modelValue:i.idTipoVeiculo,"onUpdate:modelValue":e[5]||(e[5]=s=>i.idTipoVeiculo=s),editable:"",options:a.tipoVeiculos,optionLabel:"opcao",optionValue:"id",placeholder:"Selecione o tipo de veículo",class:f(["w-full",{"p-invalid":i.errors.idTipoVeiculo}])},null,8,["modelValue","options","class"]),o("small",jo,m(i.errors.idTipoVeiculo||""),1)]),o("div",Fo,[Ro,l(g,{modelValue:i.idMarca,"onUpdate:modelValue":e[6]||(e[6]=s=>i.idMarca=s),editable:"",options:a.marcas,optionLabel:"opcao",optionValue:"id",placeholder:"Selecione a marca",class:f(["w-full",{"p-invalid":i.errors.idMarca}])},null,8,["modelValue","options","class"]),o("small",Oo,m(i.errors.idMarca||""),1)]),o("div",Po,[zo,l(g,{modelValue:i.idModelo,"onUpdate:modelValue":e[7]||(e[7]=s=>i.idModelo=s),editable:"",options:a.modelos,optionLabel:"opcao",optionValue:"id",placeholder:"Selecione o modelo",class:f(["w-full",{"p-invalid":i.errors.idModelo}])},null,8,["modelValue","options","class"]),o("small",Ho,m(i.errors.idModelo||""),1)]),o("div",Ko,[Go,l(g,{modelValue:i.idVeiculoCombustivel,"onUpdate:modelValue":e[8]||(e[8]=s=>i.idVeiculoCombustivel=s),editable:"",options:a.combustiveis,optionLabel:"opcao",optionValue:"id",placeholder:"Selecione tipo de combustível",class:f(["w-full",{"p-invalid":i.errors.idVeiculoCombustivel}])},null,8,["modelValue","options","class"]),o("small",Jo,m(i.errors.idVeiculoCombustivel||""),1)])]),Qo])):x("",!0),a.tabAtiva==1?(p(),_("div",Wo,Yo)):x("",!0),(p(),B(Y,null,[a.tabAtiva==2?(p(),B(d,{key:0,idVeiculo:a.id},null,8,["idVeiculo"])):x("",!0)],1024)),a.tabAtiva==3?(p(),_("div",Zo,[o("div",$o,[o("div",oe,[ee,o("div",ie,[l(b,{type:"text",modelValue:i.placa,"onUpdate:modelValue":e[9]||(e[9]=s=>i.placa=s),placeholder:"",class:f({"p-invalid":i.errors.placa})},null,8,["modelValue","class"]),l(v,{icon:"pi pi-search",severity:"primary","aria-label":"Buscar"})])]),o("div",se,[le,l(b,{type:"text",modelValue:i.renavam,"onUpdate:modelValue":e[10]||(e[10]=s=>i.renavam=s),placeholder:"",class:f({"p-invalid":i.errors.renavam}),inputId:"withoutgrouping",useGrouping:!1},null,8,["modelValue","class"]),o("small",te,m(i.errors.renavam||""),1)]),o("div",ae,[ce,o("div",ne,[l(b,{type:"text",modelValue:i.placa,"onUpdate:modelValue":e[11]||(e[11]=s=>i.placa=s),placeholder:"",class:f({"p-invalid":i.errors.placa})},null,8,["modelValue","class"]),l(v,{icon:"pi pi-plus",label:"Incluir",severity:"primary","aria-label":"Incluir"})])]),o("div",de,[l(j,{value:t.registros,class:"p-datatable backgroud-color-white mt-4",style:{"min-height":"100%"},rows:5,dataKey:"id",rowHover:!0,filterDisplay:"menu",loading:a.loading,responsiveLayout:"scroll"},Z({loading:u(()=>[re]),footer:u(()=>[]),default:u(()=>[l(y,{field:"id",header:"Cód.",bodyClass:"text-left",style:{"min-width":"2rem"}},{body:u(({data:s})=>[o("span",ue,m(s.id),1)]),_:1}),l(y,{field:"descricao",header:"Descrição",style:{"min-width":"12rem"}},{body:u(({data:s})=>[V(m(s.descricao),1)]),_:1}),l(y,{field:"descricao",header:"Valor da Despesa",style:{"min-width":"4rem"}},{body:u(({data:s})=>[V(m(s.descricao),1)]),_:1}),l(y,{field:"Edit",header:"",dataType:"boolean",bodyClass:"text-right",style:{"min-width":"4rem"}},{body:u(({data:s})=>[s.editavel?(p(),_("div",me,[l(k,{to:`/cadastros/tipos-veiculos/editar/${s.id}`},{default:u(()=>[L(l(v,{icon:"pi pi-user-edit",class:"p-button-rounded p-button-text",text:"",rounded:""},null,512),[[D,"Editar",void 0,{top:!0}]])]),_:2},1032,["to"]),L(l(v,{icon:"pi pi-trash",class:"p-button-rounded p-button-text",text:"",rounded:"",onClick:he=>t.showTemplate(s.id,`Deseja realmente excluir o tipo de veiculo ${s.descricao}?`)},null,8,["onClick"]),[[D,"Excluir",void 0,{top:!0}]])])):x("",!0)]),_:1})]),_:2},[a.loading?void 0:{name:"empty",fn:u(()=>[V("Nenhuma despesa cadastrada. ")]),key:"0"}]),1032,["value","loading"])])])])):x("",!0),a.tabAtiva==4?(p(),_("div",pe)):x("",!0)])])])]),l(F,null,{start:u(()=>[l(k,{to:"/cadastros/veiculos"},{default:u(()=>[l(v,{label:"Voltar",icon:"pi pi-undo",class:"p-button-secondary mr-2"})]),_:1})]),end:u(()=>[o("div",ve,[l(v,{label:"Salvar",icon:"pi pi-save",class:"p-button-sucess mr-4",loading:a.loading,raised:"",onClick:T.submit},null,8,["loading","onClick"])])]),_:1})],64)}const Ie=N(fo,[["render",_e],["__scopeId","data-v-c6af43b5"]]);export{Ie as default};
