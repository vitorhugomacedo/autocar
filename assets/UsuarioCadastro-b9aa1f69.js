import{U as x}from"./UsuarioEmpresaService-f9569951.js";import{P as C}from"./PerfilUsuarioService-ba568dd0.js";import{_ as w,l as E,m as k,n as I,b as a,c as U,d as g,f as e,e as i,t as c,g as m,F as T,k as B,q as b}from"./index-def3a469.js";import{c as D,a as S,b as N,d as q}from"./index.esm-960d875f.js";import"./UrlService-8cfe23a9.js";const F={name:"UsuariosCadastro",components:{},setup(){const t=E(),o=k(),d=new x,s=new C,{errors:r,handleSubmit:p,defineField:n}=I({validationSchema:D({nome:S().required("Campo obrigatório"),email:S().required("Campo obrigatório"),idPerfilUsuario:N().required("Campo obrigatório"),ativo:q()})}),[h]=n("nome"),[u]=n("email"),[_]=n("idPerfilUsuario"),[f]=n("ativo");return{router:t,toast:o,usuarioEmpresaService:d,perfilUsuarioService:s,nome:h,email:u,idPerfilUsuario:_,ativo:f,handleSubmit:p,errors:r}},data(){return{breadcrumbHome:{icon:"pi pi-home",to:"/"},breadcrumbItems:[],titulo:"",isEdicao:!1,perfisUsuarios:[],id:0,onSubmit:null,loading:!1}},async mounted(){if(this.isEdicao=this.router.currentRoute.value.fullPath.includes("editar"),this.titulo=this.isEdicao?"Editar Usuário":"Novo Usuário",this.breadcrumbItems=[{label:"Configurações",to:"/configuracoes/usuarios"},{label:"Usuários",to:"/configuracoes/usuarios"},{label:this.titulo,to:"#"}],this.perfisUsuarios=await this.perfilUsuarioService.getOptions(),this.isEdicao){const t=this.router.currentRoute.value.params.id,o=await this.usuarioEmpresaService.get(t);this.id=o.id,this.nome=o.nome,this.email=o.email,this.idPerfilUsuario=o.perfilUsuario.id,this.ativo=o.ativo}this.onSubmit=this.handleSubmit(async t=>{const o={id:this.id,nome:t.nome,email:t.email,idPerfilUsuario:t.idPerfilUsuario,ativo:t.ativo};try{this.loading=!0,this.id?await this.usuarioEmpresaService.update(o):await this.usuarioEmpresaService.create(o),this.toast.add({severity:"success",summary:"Cadastro salvo com sucesso",detail:"",life:3e3}),setTimeout(()=>{this.router.push("/configuracoes/usuarios")},400)}catch(d){this.toast.add({severity:"error",summary:d.message,detail:"",life:3e3}),this.loading=!1}})},methods:{submit:async function(){this.onSubmit()}}},R={class:"font-medium text-2xl text-color"},H={class:"grid p-fluid"},O={class:"col-12 md:col-12"},z={class:"card"},A={key:0},G={class:"p-input-title"},L={class:"grid formgrid"},j={class:"col-12 mb-2 lg:col-4"},J=i("h6",{class:"p-input-title"},"Nome",-1),K={class:"p-error",id:"text-error"},M={class:"col-12 mb-2 lg:col-4"},Q=i("h6",{class:"p-input-title"},"E-mail",-1),W={class:"p-error",id:"text-error"},X={class:"col-12 mb-2 lg:col-3"},Y=i("h6",{class:"p-input-title"},"Perfil de Usuário",-1),Z={class:"p-error",id:"text-error"},$={class:"col-12 mb-2 lg:col-1"},oo=i("h6",{class:"p-input-title"},"Ativo",-1),io={class:"my-2"};function so(t,o,d,s,r,p){const n=a("Toast"),h=a("Breadcrumb"),u=a("InputText"),_=a("Dropdown"),f=a("InputSwitch"),P=a("Panel"),v=a("Button"),V=a("router-link"),y=a("Toolbar");return U(),g(T,null,[e(n),i("div",R,c(r.titulo),1),e(h,{home:r.breadcrumbHome,model:r.breadcrumbItems},null,8,["home","model"]),i("div",H,[i("div",O,[i("div",z,[i("form",null,[e(P,{header:"Dados Principais",class:"mb-4"},{default:m(()=>[r.id?(U(),g("div",A,[i("h6",G,"CÓDIGO: "+c(this.id),1)])):B("",!0),i("div",L,[i("div",j,[J,e(u,{modelValue:s.nome,"onUpdate:modelValue":o[0]||(o[0]=l=>s.nome=l),class:b({"p-invalid":s.errors.nome}),type:"text"},null,8,["modelValue","class"]),i("small",K,c(s.errors.nome||""),1)]),i("div",M,[Q,e(u,{modelValue:s.email,"onUpdate:modelValue":o[1]||(o[1]=l=>s.email=l),class:b({"p-invalid":s.errors.email}),type:"text"},null,8,["modelValue","class"]),i("small",W,c(s.errors.email||""),1)]),i("div",X,[Y,e(_,{modelValue:s.idPerfilUsuario,"onUpdate:modelValue":o[2]||(o[2]=l=>s.idPerfilUsuario=l),editable:"",options:r.perfisUsuarios,optionLabel:"opcao",optionValue:"id",placeholder:"Selecione o perfil do usuário",class:b(["w-full",{"p-invalid":s.errors.idPerfilUsuario}])},null,8,["modelValue","options","class"]),i("small",Z,c(s.errors.idPerfilUsuario||""),1)]),i("div",$,[oo,e(f,{modelValue:s.ativo,"onUpdate:modelValue":o[3]||(o[3]=l=>s.ativo=l)},null,8,["modelValue"])])])]),_:1})])]),e(y,null,{start:m(()=>[e(V,{to:"/configuracoes/usuarios"},{default:m(()=>[e(v,{label:"Voltar",icon:"pi pi-undo",class:"p-button-secondary mr-2",raised:""})]),_:1})]),end:m(()=>[i("div",io,[e(v,{label:"Salvar",icon:"pi pi-save",class:"p-button-sucess mr-4",loading:r.loading,raised:"",onClick:p.submit},null,8,["loading","onClick"])])]),_:1})])])],64)}const no=w(F,[["render",so]]);export{no as default};
